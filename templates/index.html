<!DOCTYPE html>
<html>
<head>
  <title>Student Database</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <h2>Student Data</h2>
  <a href="/add">Add New Student</a>
  <input type="text" id="search" placeholder="Search by name, email, or course...">
  <table border="1" id="studentsTable">
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Email</th>
        <th>Course</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="studentsBody">
      {% for s in students %}
      <tr>
        <td>{{ s[0] }}</td>
        <td>{{ s[1] }}</td>
        <td>{{ s[2] }}</td>
        <td>{{ s[3] }}</td>
        <td><a href="/delete/{{ s[0] }}">Delete</a></td>
      </tr>
      {% endfor %}
    </tbody>

  </table>

  <script>
  document.getElementById('search').addEventListener('input', async function() {
    const query = this.value.trim();
    const response = await fetch(`/api/search?q=${encodeURIComponent(query)}`);
    const data = await response.json();

    const tbody = document.getElementById('studentsBody');
    tbody.innerHTML = '';

    if (data.length === 0) {
      tbody.innerHTML = '<tr><td colspan="4">No results found</td></tr>';
      return;
    }

    data.forEach(row => {
      const tr = document.createElement('tr');
      row.forEach(cell => {
        const td = document.createElement('td');
        td.textContent = cell;
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    });
  });
  </script>

